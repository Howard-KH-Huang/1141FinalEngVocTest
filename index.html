<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ëê¨‰æÜÂúãÂ∞èËã±Ë™ûÂñÆÂ≠óÊ∏¨È©óÂπ≥Âè∞</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #FFF5E1; }
        @keyframes confetti-fall { 
            0% { transform: translateY(-10vh) rotate(0deg); } 
            100% { transform: translateY(110vh) rotate(720deg); } 
        }
        .animate-confetti-fall { animation: confetti-fall linear infinite; }
        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #FFD166; border-radius: 10px; border: 2px solid white; }
        .lucide { width: 1.5rem; height: 1.5rem; vertical-align: middle; display: inline-block; }
        .text-shadow { text-shadow: 0 2px 4px rgba(0,0,0,0.3); }
        input[type=number]::-webkit-inner-spin-button, input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // --- ÈÖçÁΩÆÂçÄ ---
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwsxMCSMVvzWtSe46HVwXoPFQyLiXyOUVLCr4HKqZ3ZZLZoDUJkOiCvQrdxPhur2Vdydw/exec";
        const apiKey = ""; // Á≥ªÁµ±Ëá™ÂãïËôïÁêÜ

        const WORD_BANK = [
            { en: "gap", zh: "ÈñìÈöô" }, { en: "gut", zh: "ËÖ∏ÈÅì" }, { en: "cap", zh: "È¥®ËàåÂ∏Ω" },
            { en: "cut", zh: "Âàá;Ââ™" }, { en: "gum", zh: "Âè£È¶ôÁ≥ñ" }, { en: "cat", zh: "Ë≤ì" },
            { en: "gas", zh: "Áì¶ÊñØ" }, { en: "cop", zh: "Ë≠¶ÂØü" }, { en: "Van", zh: "ÁÆ±ÂûãËªä" },
            { en: "vest", zh: "ËÉåÂøÉ" }, { en: "fan", zh: "ÈõªÈ¢®Êâá" }, { en: "fest", zh: "ÁØÄÊó•" },
            { en: "vat", zh: "Ê°∂" }, { en: "fat", zh: "ËÉñÁöÑ" }, { en: "vet", zh: "Áç∏ÈÜ´" },
            { en: "fox", zh: "ÁãêÁã∏" }, { en: "zip", zh: "ÊãâÈçä" }, { en: "Zack", zh: "Áî∑Â≠êÂêç" },
            { en: "sip", zh: "ÂïúÈ£≤" }, { en: "sack", zh: "È∫ªÂ∏ÉË¢ã" }, { en: "zit", zh: "ÁóòÁóò;ÁñπÂ≠ê" },
            { en: "sit", zh: "Âùê‰∏ã" }, { en: "zag", zh: "ÊÄ•ËΩâ" }, { en: "sun", zh: "Â§™ÈôΩ" },
            { en: "where", zh: "Âì™Ë£°" }, { en: "bathroom", zh: "Êµ¥ÂÆ§" }, { en: "bedroom", zh: "Ëá•Êàø" },
            { en: "kitchen", zh: "ÂªöÊàø" }, { en: "dining room", zh: "È£ØÂª≥" }, { en: "living room", zh: "ÂÆ¢Âª≥" },
            { en: "bird", zh: "È≥•" }, { en: "rabbit", zh: "ÂÖîÂ≠ê" }, { en: "turtle", zh: "ÁÉèÈæú" },
            { en: "dog", zh: "Áãó" }, { en: "fish", zh: "È≠ö" }, { en: "house", zh: "ÊàøÂ≠ê" },
            { en: "friend", zh: "ÊúãÂèã" }, { en: "bat", zh: "ËùôËù†" }, { en: "ghost", zh: "È¨º" },
            { en: "jack-o'-lantern", zh: "ÂçóÁìúÁáà" }, { en: "spider", zh: "ËúòËõõ" },
            { en: "Trick or treat.", zh: "‰∏çÁµ¶Á≥ñÂ∞±ÊêóËõã" }, { en: "Happy Halloween.", zh: "Ëê¨ËÅñÁØÄÂø´Ê®Ç" },
            { en: "ready", zh: "Ê∫ñÂÇôÂ•ΩÁöÑ" }, { en: "Good job.", zh: "ÂÅöÁöÑÂ•Ω" }, { en: "Welcome.", zh: "Ê≠°Ëøé„ÄÇ" },
            { en: "Good afternoon.", zh: "ÂçàÂÆâ„ÄÇ" }, { en: "It's tea time.", zh: "ÂñùËå∂ÊôÇÈñìÂà∞‰∫Ü" },
            { en: "Please help yourself.", zh: "Ë´ãËá™‰æø„ÄÇ" }
        ];

        const SPELLING_WORDS_LIST = ["gap", "gut", "cap", "cut", "gum", "cat", "gas", "cop", "van", "vest", "fan", "fest", "vat", "fat", "vet", "fox", "zip", "Zack", "sip", "sack", "zit", "sit", "zag", "sun", "where", "bathroom", "bedroom", "kitchen", "dining room", "living room", "bird", "rabbit", "turtle", "dog", "fish", "house", "friend", "bat", "ghost", "spider", "ready"];

        // ÂúñÁ§∫ÂÖÉ‰ª∂
        const LucideIcon = ({ name, className = "" }) => {
            useEffect(() => { if (window.lucide) window.lucide.createIcons(); }, [name]);
            return <i data-lucide={name} className={className}></i>;
        };

        // ÊííËä±ÂÖÉ‰ª∂
        const ConfettiRain = () => {
            const pieces = Array.from({ length: 80 });
            const colors = ['#FF9A9E', '#FAD0C4', '#FBC2EB', '#A18CD1', '#84FAB0', '#8FD3F4', '#FFD166', '#06D6A0'];
            return (
                <div className="fixed inset-0 pointer-events-none z-[100] overflow-hidden">
                    {pieces.map((_, i) => (
                        <div key={i} className="absolute animate-confetti-fall"
                            style={{ 
                                left: `${Math.random() * 100}%`, 
                                backgroundColor: colors[Math.floor(Math.random() * colors.length)], 
                                width: `${Math.random() * 12 + 6}px`, 
                                height: `${Math.random() * 12 + 6}px`, 
                                borderRadius: Math.random() > 0.5 ? '50%' : '2px', 
                                animationDelay: `${Math.random() * 5}s`, 
                                animationDuration: `${Math.random() * 3 + 2}s`, 
                                opacity: Math.random() * 0.5 + 0.5 
                            }}
                        />
                    ))}
                </div>
            );
        };

        const pcmToWav = (pcmBase64, sampleRate = 24000) => {
            const binaryString = atob(pcmBase64);
            const bytes = new Uint8Array(binaryString.length);
            for (let i = 0; i < binaryString.length; i++) { bytes[i] = binaryString.charCodeAt(i); }
            const pcmData = new Int16Array(bytes.buffer);
            const buffer = new ArrayBuffer(44 + pcmData.length * 2);
            const view = new DataView(buffer);
            const writeString = (offset, string) => { for (let i = 0; i < string.length; i++) { view.setUint8(offset + i, string.charCodeAt(i)); } };
            writeString(0, 'RIFF'); view.setUint32(4, 36 + pcmData.length * 2, true); writeString(8, 'WAVE'); writeString(12, 'fmt '); view.setUint32(16, 16, true); view.setUint16(20, 1, true); view.setUint16(22, 1, true); view.setUint32(24, sampleRate, true); view.setUint32(28, sampleRate * 2, true); view.setUint16(32, 2, true); view.setUint16(34, 16, true); writeString(36, 'data'); view.setUint32(40, pcmData.length * 2, true);
            for (let i = 0; i < pcmData.length; i++) { view.setInt16(44 + i * 2, pcmData[i], true); }
            return new Blob([buffer], { type: 'audio/wav' });
        };

        const App = () => {
            const [gameState, setGameState] = useState('INFO');
            const [studentInfo, setStudentInfo] = useState({ class: '', seat: '', name: '' });
            const [questions, setQuestions] = useState([]);
            const [currentIndex, setCurrentIndex] = useState(0);
            const [userAnswers, setUserAnswers] = useState([]);
            const [score, setScore] = useState(0);
            const [isAudioLoading, setIsAudioLoading] = useState(false);
            const [spellingInput, setSpellingInput] = useState('');
            const [tempSelection, setTempSelection] = useState(null);
            const [showConfetti, setShowConfetti] = useState(false);
            const [playCounts, setPlayCounts] = useState(new Array(20).fill(0));
            const [timeLeft, setTimeLeft] = useState(900);
            const [dbRowIndex, setDbRowIndex] = useState(null);
            const [isSyncing, setIsSyncing] = useState(false);
            const [leaderboard, setLeaderboard] = useState([]);
            const [isLoadingLeaderboard, setIsLoadingLeaderboard] = useState(true);

            const audioRef = useRef(null);
            const timerRef = useRef(null);
            const inputRef = useRef(null);

            useEffect(() => { fetchLeaderboard(); }, []);

            useEffect(() => {
                if (gameState === 'RESULT' && score >= 60) {
                    setShowConfetti(true);
                    const timer = setTimeout(() => { setShowConfetti(false); }, 10000);
                    return () => clearTimeout(timer);
                }
            }, [gameState, score]);

            useEffect(() => {
                if (gameState === 'QUIZ') {
                    timerRef.current = setInterval(() => {
                        setTimeLeft(prev => {
                            if (prev <= 1) { 
                                clearInterval(timerRef.current); 
                                finishQuiz(score, userAnswers, 0); 
                                return 0; 
                            }
                            return prev - 1;
                        });
                    }, 1000);
                } else clearInterval(timerRef.current);
                return () => clearInterval(timerRef.current);
            }, [gameState, score, userAnswers]);

            const fetchLeaderboard = async () => {
                try {
                    setIsLoadingLeaderboard(true);
                    const res = await fetch(SCRIPT_URL);
                    const data = await res.json();
                    setLeaderboard(data.leaderboard || []);
                } catch { } finally { setIsLoadingLeaderboard(false); }
            };

            const getEncouragement = (s) => {
                if (s === 100) return "ÂÆåÁæéÈÅîÊàêÔºÅ‰Ω†ÊòØËã±Ë™ûÂñÆÂ≠óÂ∞èË∂Ö‰∫∫ÔºåÁç≤ÂæóÊªøÂàÜÊ¶ÆË≠ΩÔºÅüèÜ";
                if (s >= 90) return "Ë∂ÖÁæ§ÁµïÂÄ´ÔºÅË°®ÁèæÈùûÂ∏∏ÂÑ™ÁßÄÔºåÈõ¢ÊªøÂàÜÂè™Ââ©‰∏ÄÊ≠•‰πãÈÅôÔºÅ‚ú®";
                if (s >= 80) return "Ë°®ÁèæÂÑ™Áï∞ÔºÅ‰Ω†Â∞çÂñÆÂ≠óÈùûÂ∏∏ÁÜüÊÇâÔºåÁπºÁ∫å‰øùÊåÅÈÄôËÇ°Ê∞£Âã¢ÔºÅüëç";
                if (s >= 70) return "ÂÅöÂæóÂ•ΩÔºÅ‰Ω†Â∑≤Á∂ìÊéåÊè°Â§ßÈÉ®ÂàÜÂñÆÂ≠ó‰∫ÜÔºåÂÜçÂä†Ê≤π‰∏ÄÈªûÈªûÔºÅüí™";
                if (s >= 60) return "Â§™Ê£í‰∫ÜÔºÅÂèäÊ†ºÂõâÔºÅÊúâÈÄ≤Ê≠•ÁöÑÁ©∫ÈñìÔºå‰∏ãÊ¨°ÊåëÊà∞Êõ¥È´òÂàÜÔºÅüòä";
                return "Âà•Ê∞£È§íÔºÅÂÜçÂ§öÁ∑¥Áøí‰∏Ä‰∏ãÔºå‰∏ãÊ¨°‰∏ÄÂÆöÂèØ‰ª•ÂèäÊ†ºÁöÑÔºåÂä†Ê≤πÔºÅüî•";
            };

            const fetchTTS = async (text) => {
                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ contents: [{ parts: [{ text: `Say clearly: ${text}` }] }], generationConfig: { responseModalities: ["AUDIO"] } })
                    });
                    const data = await response.json();
                    const pcmData = data.candidates?.[0]?.content?.parts?.find(p => p.inlineData)?.inlineData?.data;
                    return pcmData ? URL.createObjectURL(pcmToWav(pcmData)) : null;
                } catch { return null; }
            };

            const playAudio = async () => {
                if (isAudioLoading || playCounts[currentIndex] >= 2) return;
                setIsAudioLoading(true);
                const url = await fetchTTS(questions[currentIndex].en);
                if (url) {
                    audioRef.current.src = url;
                    audioRef.current.play();
                    const newCounts = [...playCounts];
                    newCounts[currentIndex] += 1;
                    setPlayCounts(newCounts);
                }
                setIsAudioLoading(false);
                if (inputRef.current) inputRef.current.focus();
            };

            const startQuiz = async () => {
                if (!studentInfo.class || !studentInfo.seat || !studentInfo.name) return;
                setIsSyncing(true);
                try {
                    const res = await fetch(SCRIPT_URL, { method: 'POST', body: JSON.stringify({ action: 'start', ...studentInfo }) });
                    const data = await res.json();
                    setDbRowIndex(data.rowIndex);
                } catch {}
                
                const shuffled = [...WORD_BANK].sort(() => Math.random() - 0.5);
                const spellingPool = WORD_BANK.filter(w => SPELLING_WORDS_LIST.includes(w.en)).sort(() => Math.random() - 0.5);
                const qSpelling = spellingPool.slice(0, 5).map(w => ({ ...w, type: 'SPELLING', section: 'Á¨¨‰∏âÂ§ßÈ°åÔºöËÅΩÈü≥ÊãºÂ≠ó' }));
                const pickedEn = new Set(qSpelling.map(w => w.en));
                const remaining = shuffled.filter(w => !pickedEn.has(w.en));
                const qListen = remaining.slice(0, 5).map(w => ({ 
                    ...w, type: 'LISTENING_SELECT', section: 'Á¨¨‰∏ÄÂ§ßÈ°åÔºöËÅΩÈü≥ÈÅ∏Â≠ó',
                    options: [...WORD_BANK.filter(x => x.en !== w.en).sort(() => Math.random() - 0.5).slice(0, 3).map(x => x.en), w.en].sort(() => Math.random() - 0.5)
                }));
                const qText = remaining.slice(5, 15).map(w => ({ 
                    ...w, type: 'TEXT', section: 'Á¨¨‰∫åÂ§ßÈ°åÔºöÁúãËã±ÈÅ∏‰∏≠',
                    options: [...WORD_BANK.filter(x => x.en !== w.en).sort(() => Math.random() - 0.5).slice(0, 3).map(x => x.zh), w.zh].sort(() => Math.random() - 0.5)
                }));

                setQuestions([...qListen, ...qText, ...qSpelling]);
                setGameState('QUIZ');
                setIsSyncing(false);
            };

            const finishQuiz = async (fScore, fAnswers, remainingTime) => {
                setGameState('RESULT');
                setIsSyncing(true);
                if (dbRowIndex) {
                    const durationSec = 900 - remainingTime;
                    const dur = `${Math.floor(durationSec/60)}ÂàÜ${durationSec%60}Áßí`;
                    await fetch(SCRIPT_URL, {
                        method: 'POST',
                        body: JSON.stringify({ action: 'end', rowIndex: dbRowIndex, score: fScore, duration: dur, errors: fAnswers.filter(a => !a.isCorrect).map(a => a.en).join(', ') })
                    });
                }
                setIsSyncing(false);
                fetchLeaderboard();
            };

            const confirm = () => {
                const q = questions[currentIndex];
                const userVal = q.type === 'SPELLING' ? spellingInput.trim() : tempSelection;
                const isCorrect = q.type === 'SPELLING' ? userVal.toLowerCase() === q.en.toLowerCase() : (q.type === 'TEXT' ? userVal === q.zh : userVal === q.en);
                const newAns = [...userAnswers, { en: q.en, selected: userVal, isCorrect, section: q.section, type: q.type, correct: q.type === 'TEXT' ? q.zh : q.en }];
                const newScore = isCorrect ? score + 5 : score;
                setUserAnswers(newAns);
                setScore(newScore);
                setSpellingInput('');
                setTempSelection(null);
                if (currentIndex < 19) setCurrentIndex(currentIndex + 1);
                else finishQuiz(newScore, newAns, timeLeft);
            };

            const formatTimeDisplay = (s) => `${Math.floor(s/60)}:${(s%60).toString().padStart(2,'0')}`;

            return (
                <div class="min-h-screen flex items-center justify-center p-4">
                    <audio ref={audioRef} hidden />
                    {showConfetti && <ConfettiRain />}
                    
                    <div class="max-w-xl w-full bg-white rounded-[2.5rem] shadow-2xl overflow-hidden border-8 border-white ring-1 ring-pink-100 flex flex-col max-h-[90vh]">
                        <div class="bg-gradient-to-br from-[#FF416C] via-[#FF4B2B] to-[#FF8C00] p-8 text-center text-white shrink-0 relative">
                            <LucideIcon name="sparkles" className="absolute top-4 right-4 opacity-30 w-12 h-12 animate-pulse" />
                            <h1 class="text-2xl font-black drop-shadow-md text-shadow">Ëê¨‰æÜÂúãÂ∞èËã±Ë™ûÂñÆÂ≠óÊ∏¨È©óÂπ≥Âè∞</h1>
                            <p class="mt-2 bg-black/20 px-4 py-1 rounded-full inline-block text-xs font-bold border border-white/20">114-1_ÂõõÂπ¥Á¥öËã±Ë™ûÁ¨¨‰∫åÊ¨°Ë©ïÈáèÂñÆÂ≠ó</p>
                        </div>

                        <div class="flex-1 overflow-y-auto custom-scrollbar p-8">
                        {gameState === 'INFO' ? (
                            <div class="space-y-6 text-center">
                                <div class="bg-[#E0F7FA] w-16 h-16 rounded-3xl flex items-center justify-center mx-auto mb-4 rotate-3 shadow-sm">
                                    <LucideIcon name="graduation-cap" className="text-[#00ACC1] w-10 h-10" />
                                </div>
                                <div class="space-y-4">
                                    <div class="flex gap-3">
                                        <input class="flex-1 p-4 rounded-2xl border-4 border-[#F3E5F5] outline-none font-bold text-center" placeholder="Áè≠Á¥ö" value={studentInfo.class} onChange={e => setStudentInfo({...studentInfo, class: e.target.value})} />
                                        <input class="w-24 p-4 rounded-2xl border-4 border-[#FFF3E0] outline-none font-bold text-center" placeholder="Â∫ßËôü" type="number" value={studentInfo.seat} onChange={e => setStudentInfo({...studentInfo, seat: e.target.value})} />
                                    </div>
                                    <input class="w-full p-4 rounded-2xl border-4 border-[#E8F5E9] outline-none font-bold text-center" placeholder="ÂßìÂêç" value={studentInfo.name} onChange={e => setStudentInfo({...studentInfo, name: e.target.value})} />
                                </div>
                                <button onClick={startQuiz} disabled={isSyncing} class="w-full bg-[#FF6B6B] py-5 rounded-3xl text-white font-black text-xl shadow-lg active:scale-95 transition-all disabled:bg-slate-300">
                                    {isSyncing ? "ÂêåÊ≠•‰∏≠..." : "Âá∫ÁôºÂõâÔºÅ"}
                                </button>
                                
                                <div class="pt-6 border-t-2 border-dashed border-slate-100">
                                    <h3 class="text-[#FFA000] font-black uppercase flex items-center justify-center gap-2 mb-4"><LucideIcon name="crown" className="w-5 h-5" /> Ê¶ÆË≠ΩÊéíË°åÊ¶ú (Top 10)</h3>
                                    {isLoadingLeaderboard ? <div class="animate-pulse text-slate-300 font-bold py-10">ËºâÂÖ•ÊéíË°åÊ¶ú‰∏≠...</div> : 
                                    <div class="bg-white rounded-3xl border-4 border-slate-50 overflow-hidden text-xs mx-auto max-w-[95%]">
                                        <table class="w-full">
                                            <thead class="bg-slate-50 text-slate-400 uppercase tracking-widest font-black text-[9px]"><tr><th class="p-3">#</th><th class="p-3 text-left">ÂßìÂêç</th><th class="p-3">ÂæóÂàÜ</th><th class="p-3 text-right">‰ΩúÁ≠îÊôÇÈñì</th></tr></thead>
                                            <tbody class="font-bold">
                                                {leaderboard.map((e,i)=>(<tr key={i} class="border-t border-slate-50 hover:bg-slate-50/50 transition-colors"><td class="p-3 text-center">{i === 0 ? "üèÜ" : i === 1 ? "ü•à" : i === 2 ? "ü•â" : i + 1}</td><td class="p-3 text-left text-slate-700 truncate max-w-[80px]">{e.name}</td><td class="p-3 text-center text-red-500 font-black text-sm">{e.score}</td><td class="p-3 text-right text-slate-400 text-[10px]">{e.durationDisplay}</td></tr>))}
                                            </tbody>
                                        </table>
                                    </div>}
                                </div>
                            </div>
                        ) : gameState === 'QUIZ' ? (
                            <div class="space-y-6">
                                <div class="flex justify-between items-center">
                                    <span class="bg-[#FFE082] text-[#FF8F00] px-3 py-1 rounded-lg font-black text-[10px] uppercase">{questions[currentIndex].section.split('Ôºö')[0]}</span>
                                    <div class="flex items-center gap-2 text-orange-600 font-black px-3 py-1 bg-orange-50 rounded-xl">
                                        <LucideIcon name="clock" className="w-4 h-4" />
                                        {formatTimeDisplay(timeLeft)}
                                    </div>
                                </div>
                                <div class="bg-slate-50 p-6 rounded-[2rem] text-center border-4 border-slate-100 shadow-inner">
                                    {questions[currentIndex].type !== 'TEXT' ? (
                                        <div class="space-y-4">
                                            <button onClick={playAudio} disabled={playCounts[currentIndex] >= 2 || isAudioLoading} class={`p-8 rounded-full border-8 border-white shadow-lg transition-all ${playCounts[currentIndex] >= 2 ? 'bg-slate-200 grayscale shadow-none' : 'bg-[#FFD166] active:scale-95'}`}>
                                                <LucideIcon name={playCounts[currentIndex] >= 2 ? "ban" : (isAudioLoading ? "loader-2" : "volume-2")} className={`w-12 h-12 text-white ${isAudioLoading ? 'animate-spin' : ''}`} />
                                            </button>
                                            <div class="px-4 py-1 rounded-full font-black text-xs inline-block bg-[#FFF9C4] text-[#FFA000]">Ââ©È§òÊ¨°Êï∏: {2 - playCounts[currentIndex]} / 2</div>
                                        </div>
                                    ) : <h2 class="text-5xl font-black text-slate-800 tracking-tighter leading-tight">{questions[currentIndex].en}</h2>}
                                </div>
                                {questions[currentIndex].type === 'SPELLING' ? (
                                    <div class="space-y-4">
                                        <input ref={inputRef} class="w-full p-5 text-3xl text-center font-black border-4 border-[#D1C4E9] rounded-3xl outline-none uppercase bg-[#EDE7F6]/30 focus:border-[#673AB7] transition-all" placeholder="Âú®Ê≠§ÊãºÂ≠ó" value={spellingInput} onChange={e => setSpellingInput(e.target.value)} onKeyPress={e => e.key === 'Enter' && confirm()} />
                                        <button onClick={confirm} disabled={!spellingInput.trim()} class="w-full bg-[#06D6A0] py-5 rounded-3xl text-white font-black text-xl shadow-md active:scale-95 transition-all">Á¢∫Ë™çÈÄÅÂá∫</button>
                                    </div>
                                ) : (
                                    <div class="space-y-4">
                                        <div class="grid grid-cols-1 gap-2">
                                            {questions[currentIndex].options.map((opt, i) => (
                                                <button key={i} onClick={() => setTempSelection(opt)} class={`p-4 text-left rounded-2xl border-b-4 font-black transition-all flex items-center gap-3 ${tempSelection === opt ? 'bg-orange-400 border-orange-600 text-white translate-y-1 border-b-0 ring-4 ring-orange-100 shadow-inner' : 'bg-slate-100 border-slate-300 hover:bg-slate-200 shadow-sm'}`}>
                                                    <span class={`w-8 h-8 flex items-center justify-center rounded-lg font-black ${tempSelection === opt ? 'bg-white text-orange-400' : 'bg-slate-200'}`}>{String.fromCharCode(65+i)}</span>{opt}
                                                </button>
                                            ))}
                                        </div>
                                        <button onClick={confirm} disabled={!tempSelection} class="w-full bg-[#FF6B6B] py-5 rounded-3xl text-white font-black text-xl shadow-md active:scale-95 disabled:bg-slate-200 transition-all">Á¢∫ÂÆöÁ≠îÊ°à</button>
                                    </div>
                                )}
                            </div>
                        ) : (
                            <div class="text-center space-y-6 animate-in fade-in zoom-in duration-500">
                                <div class="bg-yellow-50 w-24 h-24 rounded-full flex items-center justify-center mx-auto shadow-inner">
                                    <LucideIcon name="trophy" className="w-14 h-14 text-[#FBC02D] animate-bounce" />
                                </div>
                                <div class="px-2">
                                    <h2 class="text-2xl font-black text-slate-800 tracking-tighter leading-tight">
                                        {getEncouragement(score)}
                                    </h2>
                                </div>
                                <div class="bg-indigo-600 p-6 rounded-[2rem] text-white shadow-xl">
                                    <p class="opacity-80 text-xs font-bold uppercase tracking-widest">{studentInfo.class} / {studentInfo.seat} Ëôü</p>
                                    <h3 class="text-2xl font-black tracking-tight truncate">{studentInfo.name}</h3>
                                    <h4 class="text-5xl font-black mt-2 leading-none">{score} PTS</h4>
                                </div>
                                {isSyncing && <div class="text-indigo-600 font-bold animate-pulse text-sm flex items-center justify-center gap-2"><LucideIcon name="loader-2" className="animate-spin w-4 h-4" /> ÊàêÁ∏æÊõ¥Êñ∞‰∏≠...</div>}
                                <button onClick={() => window.location.reload()} class="w-full bg-slate-900 py-5 rounded-3xl text-white font-black text-xl shadow-lg hover:bg-black active:scale-95 transition-all flex items-center justify-center gap-2"><LucideIcon name="refresh-ccw" className="w-6 h-6" /> ÂÜçÊà∞‰∏ÄÂ†¥ÔºÅ</button>
                            </div>
                        )}
                        </div>

                        <div class="p-4 bg-white/80 backdrop-blur-md text-center border-t border-slate-100 shrink-0">
                            <p class="text-[#FF9A9E] text-[10px] font-black uppercase tracking-[0.2em] flex items-center justify-center gap-2">
                                <span class="w-2 h-2 rounded-full bg-pink-400 animate-ping"></span>
                                Wanlai Elementary School ‚Ä¢ 114-1_Vocabulary Quiz System
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
